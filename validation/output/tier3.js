/* Generated by the Nim Compiler v2.2.6 */
var framePtr = null;
var excHandler = 0;
var lastJSError = null;
var objectID_754974898 = [0];
async function fetch(request_p0, env_p1) {
  var result_553648231 = null;

  BeforeRet: {
    if ((request_p0.method == "OPTIONS")) {
    result_553648231 = new Response("", {status: 204});
    break BeforeRet;
    }
    
    if (!((request_p0.method == "POST"))) {
    result_553648231 = new Response("{\"error\":\"Method not allowed\"}", {status: 405});
    break BeforeRet;
    }
    
    var body_553648251 = (await request_p0.json());
    var url_553648264 = (body_553648251.url);
    if ((((url_553648264) == null ? 0 : (url_553648264).length) == 0)) {
    result_553648231 = new Response("{\"error\":\"Missing url\"}", {status: 400});
    break BeforeRet;
    }
    
    var envKey_553648268 = "OPENAI_KEY".toUpperCase();
    var resp_553648279 = JSON.stringify({["ok"]: true, ["url"]: url_553648264, ["key_env"]: envKey_553648268});
    result_553648231 = new Response(resp_553648279, {status: 200});
    break BeforeRet;
  };

  return result_553648231;

}
